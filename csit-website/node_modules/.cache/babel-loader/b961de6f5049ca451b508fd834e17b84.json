{"ast":null,"code":"var _jsxFileName = \"G:\\\\INTERNSHIPFILES\\\\CodingFolder\\\\csit-website\\\\src\\\\Components\\\\maps.js\";\nimport React from 'react';\nimport mapboxgl from 'mapbox-gl';\nmapboxgl.accessToken = 'pk.eyJ1IjoiYXF1YWltcGFjdCIsImEiOiJja2R0d2N3emswdzlwMnptcGliNTk4ZHNkIn0.jPYEzZD-aErgL25Zx9N_Kg';\nlet map;\n\nclass Maps extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lng: 103.851959,\n      lat: 1.290270,\n      zoom: 9.5,\n      movements: [],\n      maps: {},\n      profiles: []\n    };\n    this.mapContainer = React.createRef();\n  }\n\n  getMovements(id) {\n    fetch(`http://localhost:8080/getMovementbyID?IDs=${id}`).then(r => r.json()).then(data => this.setState({\n      movements: data\n    }));\n  }\n\n  componentDidMount() {\n    this.getMovements(this.props.UID);\n    map = new mapboxgl.Map({\n      container: this.mapContainer,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [this.state.lng, this.state.lat],\n      zoom: this.state.zoom\n    });\n  }\n\n  getDatetime(datetime, selection) {\n    let date = new Date(datetime);\n    date = (date + \"\").split(\" \");\n    let mon = date[1];\n    let day = date[2];\n    let year = date[3];\n    let fullTime = date[4].split(\":\");\n    let hh = fullTime[0];\n    let min = fullTime[1];\n    let sec = fullTime[2]; // const monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n\n    let finalDatetime;\n\n    if (selection == \"d\") {\n      finalDatetime = day + \" \" + mon + \" \" + year;\n    } else if (selection == \"t\") {\n      let timing = \"AM\";\n\n      if (parseInt(hh) == 12) {\n        timing = \"PM\";\n      }\n\n      if (parseInt(hh) > 12) {\n        hh = parseInt(hh) - 12;\n        timing = \"PM\";\n      }\n\n      finalDatetime = hh + \":\" + min + \" \" + timing;\n    } else if (selection == \"dt\") {\n      finalDatetime = new Date(datetime);\n    }\n\n    return finalDatetime;\n  }\n\n  getPeople(id) {\n    fetch(`http://localhost:8080/getPeopleTiming?IDs=${id}`).then(r => r.json()).then(x => this.setState({\n      profiles: x\n    }));\n  }\n\n  render() {\n    if (map != undefined) {\n      let UPoints = this.state.movements.map(x => {\n        return {\n          'type': 'Feature',\n          'properties': {\n            'movementID': x.id,\n            'description': `<strong>${x.locationShortaddress}</strong><p>Time Entered: ${this.getDatetime(x.datetimeEntered, 't')}</p><p>Time Left: ${this.getDatetime(x.datetimeLeft, 't')}</p><p>Date: ${this.getDatetime(x.datetimeLeft, 'd')}</p>`\n          },\n          'geometry': {\n            'type': 'Point',\n            'coordinates': [x.locationLong, x.locationLat]\n          }\n        };\n      });\n      let UMovements = this.state.movements.map(x => {\n        return [x.locationLong, x.locationLat];\n      });\n      let that = this;\n      map.on('load', function () {\n        map.loadImage('https://docs.mapbox.com/mapbox-gl-js/assets/custom_marker.png', // Add an image to use as a custom marker\n        function (error, image) {\n          if (error) throw error;\n          map.addImage('custom-marker', image);\n          map.addSource('places', {\n            'type': 'geojson',\n            'data': {\n              'type': 'FeatureCollection',\n              'features': UPoints\n            }\n          }); // Add a layer showing the places.\n\n          map.addLayer({\n            'id': 'places',\n            'type': 'symbol',\n            'source': 'places',\n            'layout': {\n              'icon-image': 'custom-marker',\n              'icon-allow-overlap': true\n            }\n          });\n          map.addSource('route', {\n            'type': 'geojson',\n            'data': {\n              'type': 'Feature',\n              'properties': {},\n              'geometry': {\n                'type': 'LineString',\n                'coordinates': UMovements\n              }\n            }\n          });\n          map.addLayer({\n            'id': 'route',\n            'type': 'line',\n            'source': 'route',\n            'layout': {\n              'line-join': 'round',\n              'line-cap': 'round'\n            },\n            'paint': {\n              'line-color': '#888',\n              'line-width': 8\n            }\n          });\n        }); // Create a popup, but don't add it to the map yet.\n\n        var popup = new mapboxgl.Popup({\n          closeButton: false,\n          closeOnClick: false\n        });\n        map.on('click', 'places', function (e) {\n          var description = e.features[0].properties.description;\n          var movementID = e.features[0].properties.movementID; // console.log(movementID)\n\n          that.getPeople(movementID);\n          that.props.callbackFromParent(that.state.profiles);\n        });\n        map.on('mouseenter', 'places', function (e) {\n          // Change the cursor style as a UI indicator.\n          map.getCanvas().style.cursor = 'pointer';\n          var coordinates = e.features[0].geometry.coordinates.slice();\n          var description = e.features[0].properties.description; // Ensure that if the map is zoomed out such that multiple\n          // copies of the feature are visible, the popup appears\n          // over the copy being pointed to.\n\n          while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n          } // Populate the popup and set its coordinates\n          // based on the feature found.\n\n\n          popup.setLngLat(coordinates).setHTML(description).addTo(map);\n        });\n        map.on('mouseleave', 'places', function () {\n          map.getCanvas().style.cursor = '';\n          popup.remove();\n        });\n      });\n    } // console.log(this.props.UID)\n    // let mappingsCC = this.state.profiles.filter(data => data.caseNumber != null).map(data => {\n    //     return({\n    //         caseNumber:data.caseNumber,\n    //         UID:data.peopleProfileId,\n    //         name:data.firstName + \" \" + data.lastName,\n    //         place:data.locationShortaddress,\n    //         datetime:this.convertSQLDate(data.datetimeEntered, data.datetimeLeft)\n    //     })\n    // })\n    // let mappingsPATP = this.state.datas.filter(data => data.caseNumber == null).map(data =>{\n    //     return({\n    //         UID:data.peopleProfileId,\n    //         name:data.firstName + \" \" + data.lastName,\n    //         place:data.locationShortaddress,\n    //         datetime:this.convertSQLDate(data.datetimeEntered, data.datetimeLeft)\n    //     })\n    // })\n    // map = this.state.maps\n\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        position: \"relative\",\n        height: \"300px\",\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      ref: el => this.mapContainer = el,\n      style: {\n        position: \"reletive\",\n        width: \"inherit\",\n        height: \"inherit\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nexport default Maps;","map":{"version":3,"sources":["G:/INTERNSHIPFILES/CodingFolder/csit-website/src/Components/maps.js"],"names":["React","mapboxgl","accessToken","map","Maps","Component","constructor","props","state","lng","lat","zoom","movements","maps","profiles","mapContainer","createRef","getMovements","id","fetch","then","r","json","data","setState","componentDidMount","UID","Map","container","style","center","getDatetime","datetime","selection","date","Date","split","mon","day","year","fullTime","hh","min","sec","finalDatetime","timing","parseInt","getPeople","x","render","undefined","UPoints","locationShortaddress","datetimeEntered","datetimeLeft","locationLong","locationLat","UMovements","that","on","loadImage","error","image","addImage","addSource","addLayer","popup","Popup","closeButton","closeOnClick","e","description","features","properties","movementID","callbackFromParent","getCanvas","cursor","coordinates","geometry","slice","Math","abs","lngLat","setLngLat","setHTML","addTo","remove","position","height","width","el"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport mapboxgl from 'mapbox-gl';\r\n\r\nmapboxgl.accessToken = 'pk.eyJ1IjoiYXF1YWltcGFjdCIsImEiOiJja2R0d2N3emswdzlwMnptcGliNTk4ZHNkIn0.jPYEzZD-aErgL25Zx9N_Kg';\r\n\r\nlet map\r\n\r\nclass Maps extends React.Component{\r\n\r\n    constructor(props){\r\n        super(props)\r\n        \r\n        this.state = {\r\n            lng: 103.851959,\r\n            lat: 1.290270,\r\n            zoom: 9.5,\r\n            movements:[],\r\n            maps:{},\r\n            profiles:[],\r\n        };\r\n\r\n        this.mapContainer = React.createRef();\r\n        \r\n    }\r\n\r\n    getMovements(id){\r\n        fetch(`http://localhost:8080/getMovementbyID?IDs=${id}`).then(r => r.json()).then(data => this.setState({movements:data}))\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getMovements(this.props.UID)\r\n\r\n        map = new mapboxgl.Map({\r\n            container: this.mapContainer,\r\n            style: 'mapbox://styles/mapbox/streets-v11',\r\n            center: [this.state.lng, this.state.lat],\r\n            zoom: this.state.zoom\r\n        });\r\n    }\r\n\r\n    getDatetime(datetime, selection){\r\n        let date = new Date(datetime)\r\n        date = (date + \"\").split(\" \")\r\n        let mon = date[1]\r\n        let day = date[2]\r\n        let year = date[3]\r\n        let fullTime = date[4].split(\":\")\r\n        let hh = fullTime[0]\r\n        let min = fullTime[1]\r\n        let sec = fullTime[2]\r\n\r\n        // const monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\r\n\r\n        let finalDatetime\r\n        if(selection == \"d\"){\r\n            finalDatetime = day + \" \" + mon + \" \" + year\r\n        }\r\n        else if(selection == \"t\"){\r\n            let timing = \"AM\"\r\n            if(parseInt(hh) == 12){\r\n                timing = \"PM\"\r\n            }\r\n            if(parseInt(hh) > 12){\r\n                hh = parseInt(hh) - 12\r\n                timing = \"PM\"\r\n            }\r\n            finalDatetime = hh + \":\" + min + \" \" + timing\r\n        }\r\n        else if(selection == \"dt\"){\r\n            finalDatetime = new Date(datetime)\r\n        }\r\n        return finalDatetime\r\n    }\r\n\r\n    getPeople(id){\r\n        fetch(`http://localhost:8080/getPeopleTiming?IDs=${id}`).then(r => r.json()).then(x => this.setState({profiles:x}))\r\n    }\r\n    render(){\r\n\r\n        if(map != undefined){\r\n            let UPoints = this.state.movements.map(x => {\r\n                return({\r\n                    'type': 'Feature',\r\n                    'properties': {\r\n                        'movementID': x.id,\r\n                        'description':\r\n                            `<strong>${x.locationShortaddress}</strong><p>Time Entered: ${this.getDatetime(x.datetimeEntered, 't')}</p><p>Time Left: ${this.getDatetime(x.datetimeLeft, 't')}</p><p>Date: ${this.getDatetime(x.datetimeLeft, 'd')}</p>`\r\n                        },\r\n                    'geometry': {\r\n                        'type': 'Point',\r\n                        'coordinates': [x.locationLong, x.locationLat]\r\n                    }\r\n                })\r\n            })\r\n    \r\n            let UMovements = this.state.movements.map(x => {\r\n                return([x.locationLong, x.locationLat])\r\n            })\r\n    \r\n            let that = this\r\n    \r\n            map.on('load', function() {\r\n    \r\n                map.loadImage(\r\n                'https://docs.mapbox.com/mapbox-gl-js/assets/custom_marker.png',\r\n                // Add an image to use as a custom marker\r\n                function(error, image) {\r\n                    if (error) throw error;\r\n                    map.addImage('custom-marker', image);\r\n                 \r\n                    map.addSource('places', {\r\n                        'type': 'geojson',\r\n                        'data': {\r\n                            'type': 'FeatureCollection',\r\n                            'features': UPoints\r\n                        }\r\n                    });\r\n                 \r\n                    // Add a layer showing the places.\r\n                    map.addLayer({\r\n                        'id': 'places',\r\n                        'type': 'symbol',\r\n                        'source': 'places',\r\n                        'layout': {\r\n                            'icon-image': 'custom-marker',\r\n                            'icon-allow-overlap': true\r\n                        }\r\n                    });\r\n    \r\n                    map.addSource('route', {\r\n                        'type': 'geojson',\r\n                        'data': {\r\n                            'type': 'Feature',\r\n                            'properties': {},\r\n                            'geometry': {\r\n                                'type': 'LineString',\r\n                                'coordinates': UMovements\r\n                            }\r\n                        }\r\n                    });\r\n                    \r\n                    map.addLayer({\r\n                        'id': 'route',\r\n                        'type': 'line',\r\n                        'source': 'route',\r\n                        'layout': {\r\n                            'line-join': 'round',\r\n                            'line-cap': 'round'\r\n                        },\r\n                        'paint': {\r\n                            'line-color': '#888',\r\n                            'line-width': 8\r\n                        }\r\n                    });\r\n    \r\n                });\r\n                 \r\n                // Create a popup, but don't add it to the map yet.\r\n                var popup = new mapboxgl.Popup({\r\n                    closeButton: false,\r\n                    closeOnClick: false\r\n                });\r\n                \r\n                map.on('click', 'places', function(e){\r\n                    var description = e.features[0].properties.description;\r\n                    var movementID = e.features[0].properties.movementID;\r\n                    // console.log(movementID)\r\n                    that.getPeople(movementID)\r\n                    that.props.callbackFromParent(that.state.profiles)\r\n                });\r\n    \r\n                map.on('mouseenter', 'places', function(e) {\r\n                    // Change the cursor style as a UI indicator.\r\n                    map.getCanvas().style.cursor = 'pointer';\r\n                    \r\n                    var coordinates = e.features[0].geometry.coordinates.slice();\r\n                    var description = e.features[0].properties.description;\r\n                    \r\n                    // Ensure that if the map is zoomed out such that multiple\r\n                    // copies of the feature are visible, the popup appears\r\n                    // over the copy being pointed to.\r\n                    while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\r\n                        coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\r\n                    }\r\n                    \r\n                    // Populate the popup and set its coordinates\r\n                    // based on the feature found.\r\n                    popup.setLngLat(coordinates).setHTML(description).addTo(map);\r\n                });\r\n                 \r\n                map.on('mouseleave', 'places', function() {\r\n                    map.getCanvas().style.cursor = '';\r\n                    popup.remove();\r\n                });\r\n            });\r\n        }\r\n\r\n        // console.log(this.props.UID)\r\n        \r\n        // let mappingsCC = this.state.profiles.filter(data => data.caseNumber != null).map(data => {\r\n        //     return({\r\n        //         caseNumber:data.caseNumber,\r\n        //         UID:data.peopleProfileId,\r\n        //         name:data.firstName + \" \" + data.lastName,\r\n        //         place:data.locationShortaddress,\r\n        //         datetime:this.convertSQLDate(data.datetimeEntered, data.datetimeLeft)\r\n        //     })\r\n        // })\r\n\r\n        // let mappingsPATP = this.state.datas.filter(data => data.caseNumber == null).map(data =>{\r\n        //     return({\r\n        //         UID:data.peopleProfileId,\r\n        //         name:data.firstName + \" \" + data.lastName,\r\n        //         place:data.locationShortaddress,\r\n        //         datetime:this.convertSQLDate(data.datetimeEntered, data.datetimeLeft)\r\n        //     })\r\n        // })\r\n\r\n        // map = this.state.maps\r\n\r\n        return(\r\n            <div style={{position:\"relative\",height:\"300px\", width:\"100%\"}}>\r\n                <div ref={el => this.mapContainer = el} style={{position:\"reletive\", width:\"inherit\", height:\"inherit\"}}/>\r\n            </div>\r\n            \r\n        )\r\n    }\r\n}\r\n\r\nexport default Maps"]},"metadata":{},"sourceType":"module"}